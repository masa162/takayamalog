# 運用仕様書 - takayamalog サイト開発ワークフロー

## 1. 開発の基本原則

本プロジェクトでは、コード品質と一貫性を保つため、以下の原則に基づき開発を進めます。

- **コードフォーマットの統一**: Prettier を使用し、自動的にコードスタイルを統一します。
- **型チェックの徹底**: TypeScript を使用し、開発段階での型エラーを早期に発見します。
- **Lintingによる品質維持**: ESLint を使用し、潜在的なバグやコードスタイルの問題を検出します。
- **CI/CDパイプラインの活用**: GitHub Actions を利用し、変更が本番環境にデプロイされる前に自動で品質チェックを行います。

## 2. 開発ワークフロー

新しい機能の実装、バグ修正、コンテンツの追加など、あらゆる変更は以下のワークフローに従って行います。

### ステップ1: 変更の実装

- 必要なコードの記述、ファイルの追加・編集を行います。
- Markdownファイルのコンテンツ更新、画像URLの追加などもここに含まれます。

### ステップ2: ローカルでの動作確認

- 開発サーバーを起動し、実装した変更が意図通りに動作するかを確認します。
  ```bash
  npm run dev
  ```
- ブラウザで `http://localhost:3000` (または表示されたポート) にアクセスし、機能を確認します。

### ステップ3: コードフォーマットの適用 (重要！)

- **コミットする前に、必ずこのコマンドを実行してください。**
- Prettier を実行し、コードスタイルを自動的に修正します。これにより、CIでのフォーマットエラーを防ぎます。

  ```bash
  npm run format
  ```

  - このコマンドは、変更されたファイルを自動的に整形します。整形されたファイルは `git status` で `modified` として表示されます。

### ステップ4: 型チェックとLintingの実行

- ローカルで型チェックとLintingを実行し、エラーや警告がないことを確認します。

  ```bash
  npm run type-check
  npm run lint
  ```

  - エラーや警告が表示された場合は、修正してください。

### ステップ5: 変更のコミット

- `git add` で変更をステージングします。
- 適切なコミットメッセージを付けてコミットします。
  ```bash
  git add .
  git commit -m "feat: [機能名] を追加"
  # または "fix: [バグ内容] を修正"
  ```

### ステップ6: リモートリポジトリへのプッシュ

- コミットした変更をGitHubのリモートリポジトリにプッシュします。
  ```bash
  git push origin [ブランチ名]
  ```
- プッシュ後、GitHub Actions のCIが自動的に実行され、コード品質が検証されます。

## 3. 画像管理について

- 画像はロリポップサーバーをCDNとして利用します。
- 新しい画像を追加する際は、ロリポップサーバーの適切なディレクトリにアップロードしてください。
- 画像の管理には `docs/image_management.csv` を活用し、ファイル名、URL、利用先などを記録してください。
  - `呼び出しURL` は `ベースURL` + `ディレクトリパス` + `ファイル名` で自動生成されるように設定されています。

## 4. 記事管理について

- 記事はMarkdownファイル (`.md`) で管理し、`content/articles` ディレクトリ以下にカテゴリごとのサブディレクトリを作成して格納できます。
- 新しい記事を追加する際は、`docs/article_management.csv` を活用し、スラッグの重複がないか確認し、記事のステータスやカテゴリなどを記録してください。
- Markdownファイルのフロントマター (`---` で囲まれた部分) には、`title`, `excerpt`, `category`, `publishedAt`, `thumbnail` などのメタデータを正確に記述してください。

---

**最終更新日**: 2025年7月20日
